<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ù„Ø®Ø·ÙˆØ© 2 â€” Ù…ÙˆØ§Ø¬Ù‡Ø© ØµÙˆØ±ØªÙŠÙ† Ø­ØªÙ‰ ÙŠØ¨Ù‚Ù‰ ÙØ§Ø¦Ø² ÙˆØ§Ø­Ø¯</title>
<style>
  html,body{height:100%;margin:0;background:#0b1224;color:#e5e7eb;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  h1{font-size:20px;margin:0 0 12px}
  .card{background:#0e142a;border:1px solid #2b3453;border-radius:16px;padding:14px}
  .muted{color:#9aa4bf;font-size:14px;margin-bottom:10px}
  .pair{display:grid;gap:12px;margin-top:10px}
  @media(min-width:820px){ .pair{grid-template-columns:1fr 1fr} }
  .choice{
    border:2px solid #2b3453;background:#101736;border-radius:14px;padding:14px;cursor:pointer;
    transition:border-color .2s ease, box-shadow .2s ease, transform .08s ease
  }
  .choice:hover{border-color:#22c55e;box-shadow:0 0 0 3px rgba(34,197,94,.18) inset;transform:translateY(-2px)}
  .img{width:120px;height:120px;object-fit:contain;display:block;margin:6px auto;border-radius:12px;background:#0b1324;border:1px solid #2b3453;padding:10px}
  .fallback{width:120px;height:120px;display:grid;place-items:center;margin:6px auto;border-radius:12px;background:#0b1324;border:1px solid #2b3453;padding:10px;font-size:42px}
  .title{text-align:center;font-weight:800;margin-top:6px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
  .btn{border:1px solid #2b3453;background:#0f1b34;color:#e5e7eb;border-radius:12px;padding:10px 14px;cursor:pointer;text-decoration:none;display:inline-block}
  .btn.primary{background:#22c55e;color:#052e16;border-color:transparent}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .progress{height:10px;background:#1a2444;border-radius:999px;overflow:hidden;margin:10px 0 6px}
  .bar{height:100%;width:0;background:#22c55e}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ğŸ–¼ï¸ Ø§Ù„Ø®Ø·ÙˆØ© 2 â€” Ø§Ø®ØªØ§Ø±ÙŠ ÙˆØ§Ø­Ø¯Ø© ÙÙŠ ÙƒÙ„ Ø¬ÙˆÙ„Ø©</h1>
      <div class="muted">Ø§Ø¨Ø¯Ø¦ÙŠ Ø¨Ù€ TikTok Ø¶Ø¯ Ø³Ù†Ø§Ø¨ Ø´Ø§ØªØŒ ÙˆØ§Ù„ÙØ§Ø¦Ø²Ø© ØªÙˆØ§Ø¬Ù‡ Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¨Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø­ØªÙ‰ ØªØ¨Ù‚Ù‰ ÙØ§Ø¦Ø²Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© âœ…</div>

      <div class="progress"><div id="bar" class="bar"></div></div>
      <div id="roundLabel" class="muted">Ø§Ù„Ø¬ÙˆÙ„Ø© 1</div>

      <div id="pair" class="pair" aria-live="polite"></div>

      <div class="row">
        <a class="btn" href="./step1-game.html">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</a>
        <button id="nextBtn" class="btn primary" disabled>Ø§Ù„ØªØ§Ù„ÙŠ â†’ Ù„Ø¹Ø¨Ø© 2</button>
      </div>
    </div>
  </div>

<script>
/* ============ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø±ÙˆØ§Ø¨Ø· Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„ØµÙˆØ± (fallback) ============ */
/* ÙƒÙ„ Ø¹Ù†ØµØ± Ø¹Ù†Ø¯Ù‡ Ù…ØµÙÙˆÙØ© srcs: Ø³ÙŠØ¬Ø±Ù‘Ø¨ Ø§Ù„Ø£ÙˆÙ„Ù‰ØŒ ÙˆØ¥Ù† ÙØ´Ù„Øª ÙŠÙ†ØªÙ‚Ù„ Ù„Ù„Ø«Ø§Ù†ÙŠØ©... ÙˆÙ‡ÙƒØ°Ø§ */
const ITEMS = [
  {
    id:"tiktok", name:"TikTok",
    srcs:[
      "https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg",
      "https://upload.wikimedia.org/wikipedia/en/thumb/a/a9/TikTok_logo.svg/512px-TikTok_logo.svg.png"
    ],
    emoji:"ğŸµ"
  },
  {
    id:"snapchat", name:"Ø³Ù†Ø§Ø¨ Ø´Ø§Øª",
    srcs:[
      "https://upload.wikimedia.org/wikipedia/en/a/ad/Snapchat_logo.svg",
      "https://upload.wikimedia.org/wikipedia/en/thumb/a/ad/Snapchat_logo.svg/512px-Snapchat_logo.svg.png"
    ],
    emoji:"âš¡"
  },
  {
    id:"instagram", name:"Instagram",
    srcs:[
      "https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png"
    ],
    emoji:"ğŸ“¸"
  },
  {
    id:"twitterx", name:"Twitter (X)",
    srcs:[
      "https://upload.wikimedia.org/wikipedia/commons/9/95/Twitter_new_X_logo.png",
      "https://upload.wikimedia.org/wikipedia/commons/5/53/X_logo_2023_original.svg",
      "https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/X_logo_2023_original.svg/512px-X_logo_2023_original.svg.png"
    ],
    emoji:"ğŸ¦"
  },
  {
    id:"ihsan", name:"Ø¥Ø­Ø³Ø§Ù†",
    srcs:[
      "https://ehsan.sa/assets/images/logo.svg",
      /* Ù„Ùˆ ØªØ¹Ø·Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø¨Ø¯ÙŠÙ„ Ø¹Ø§Ù… (Ù‚Ù„Ø¨) ÙƒØ­Ù„ Ù…Ø¤Ù‚Øª: */
      "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='256' height='256'><rect width='100%' height='100%' fill='%230b1324'/><text x='50%' y='55%' font-size='110' text-anchor='middle'>%E2%9D%A4%EF%B8%8F</text></svg>"
    ],
    emoji:"ğŸ’"
  },
  {
    id:"chatgpt", name:"ChatGPT",
    srcs:[
      "https://upload.wikimedia.org/wikipedia/commons/0/04/ChatGPT_logo.svg",
      "https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/ChatGPT_logo.svg/512px-ChatGPT_logo.svg.png"
    ],
    emoji:"ğŸ¤–"
  }
];

/* Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ø¬ÙˆÙ„Ø§Øª: Ø£ÙˆÙ„ Ø§Ø«Ù†ÙŠÙ† ÙŠØªÙˆØ§Ø¬Ù‡ÙˆÙ†ØŒ Ø«Ù… Ø§Ù„ÙØ§Ø¦Ø²Ø© ØªÙˆØ§Ø¬Ù‡ Ø§Ù„ØªØ§Ù„ÙŠ... */
const ORDER = ["tiktok","snapchat","instagram","twitterx","ihsan","chatgpt"];
const KEY = "GAMES_HUB_PICK";

let champion = null; // Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
let nextIndex = 0;   // Ù…Ø¤Ø´Ø± Ø¯Ø§Ø®Ù„ ORDER

function $(id){ return document.getElementById(id); }
function getItemById(id){ return ITEMS.find(x=>x.id===id); }

function createImgWithFallback(sources, alt, placeholderEmoji){
  const wrap = document.createElement("div");
  let idx = 0;
  const img = document.createElement("img");
  img.className = "img";
  img.alt = alt;

  const fallback = document.createElement("div");
  fallback.className = "fallback";
  fallback.textContent = placeholderEmoji || "ğŸ–¼ï¸";
  fallback.style.display = "none";

  function tryNext(){
    if (idx < sources.length){
      img.src = sources[idx++];
    } else {
      // Ù†ÙØ¯Øª Ø§Ù„Ø±ÙˆØ§Ø¨Ø· â†’ Ø£Ø¸Ù‡Ø± Ø¨Ø¯ÙŠÙ„
      img.style.display = "none";
      fallback.style.display = "grid";
    }
  }
  img.addEventListener("error", tryNext);
  tryNext();

  wrap.appendChild(img);
  wrap.appendChild(fallback);
  return wrap;
}

function renderPair(){
  const pairEl = $("pair");
  const bar = $("bar");
  const roundLabel = $("roundLabel");

  // Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: Ø®Ø° Ø£ÙˆÙ„ Ø§Ø«Ù†ÙŠÙ† Ù…Ù† ORDER
  if (champion === null && nextIndex === 0){
    champion = getItemById(ORDER[0]);
    nextIndex = 1; // Ø§Ù„Ù…Ù†Ø§ÙØ³ Ø§Ù„ØªØ§Ù„ÙŠ Ù‡Ùˆ ORDER[1]
  }

  // Ø¥Ù†ØªÙ‡ÙŠÙ†Ø§ØŸ (Ø¢Ø®Ø± ÙˆØ§Ø­Ø¯ ØªÙ…Ù‘Øª Ù…ÙˆØ§Ø¬Ù‡ØªÙ‡)
  if (nextIndex >= ORDER.length){
    // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆØªÙ…ÙƒÙŠÙ† Ø§Ù„ØªØ§Ù„ÙŠ
    try { localStorage.setItem(KEY, champion.id); } catch(e){}
    pairEl.innerHTML = `<div class="muted">ğŸ‰ Ø§Ù„ÙØ§Ø¦Ø²Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${champion.name} â€” Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¹Ø¨Ø© 2</div>`;
    bar.style.width = "100%";
    $("nextBtn").disabled = false;
    roundLabel.textContent = "Ø§Ù„Ù†Ù‡Ø§ÙŠØ©";
    return;
  }

  const challenger = getItemById(ORDER[nextIndex]);

  pairEl.innerHTML = "";

  [champion, challenger].forEach((item, idx)=>{
    const card = document.createElement("div");
    card.className = "choice";
    const imgWrap = createImgWithFallback(item.srcs, item.name, item.emoji);

    const title = document.createElement("div");
    title.className = "title";
    title.textContent = item.name;

    card.appendChild(imgWrap);
    card.appendChild(title);

    card.addEventListener("click", ()=>{
      // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ§Ø¦Ø²Ø©
      champion = item;
      nextIndex += 1;

      // ØªÙ‚Ø¯Ù‘Ù… Ø§Ù„Ø´Ø±ÙŠØ·
      const totalDuels = ORDER.length - 1;        // Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ø¬Ù‡Ø§Øª
      const done = Math.min(nextIndex, totalDuels);
      bar.style.width = Math.floor(done/totalDuels*100) + "%";
      $("roundLabel").textContent = (nextIndex>=ORDER.length) ? "Ø§Ù„Ù†Ù‡Ø§ÙŠØ©" : ("Ø§Ù„Ø¬ÙˆÙ„Ø© " + (done+1));

      renderPair();
    });

    pairEl.appendChild(card);
  });

  // Ø­Ø¯Ù‘Ø« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆÙˆØ³Ù… Ø§Ù„Ø¬ÙˆÙ„Ø©
  const totalDuels = ORDER.length - 1;
  const done = Math.min(nextIndex, totalDuels);
  bar.style.width = Math.floor(done/totalDuels*100) + "%";
  $("roundLabel").textContent = "Ø§Ù„Ø¬ÙˆÙ„Ø© " + (done+1);
}

$("nextBtn").addEventListener("click", ()=>{
  // Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
  window.location.href = "./step3-game.html";
});

renderPair();
</script>
</body>
</html>
